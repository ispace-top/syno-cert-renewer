## 示例docker-compose.yml文件，请根据您的实际情况修改。
version: '3.8'

services:
  cert-renewer:
    image: wapedkj/syno-cert-renewer:latest # 推荐使用最新的官方镜像
    container_name: syno-cert-renewer
    restart: always # 推荐使用 always 策略以确保服务持续运行
    volumes:
      # (必须) 使用命名卷来持久化 acme.sh 的程序和数据，Docker将自动为您管理
      - acme_sh_data:/root/.acme.sh
      
      # (必须) 挂载输出目录，用于在主机上直接获取生成的证书文件
      - ./output:/output 
      
      # (必须) 挂载一个用于缓存企业微信 access_token 的临时目录
      - ./temp:/temp

      # (可选) 如果您希望使用文件进行配置，请取消此行的注释
      # - ./config:/config
    environment:
      # --- 基础配置 (必填项) ---
      - DOMAIN=your.domain.com
      - DNS_API=dns_dp
      - ACME_EMAIL=youremail@example.com

      # --- DNS API 凭证 (以 DNSPod 为例) ---
      - DP_Id=your_dnspod_id
      - DP_Key=your_dnspod_key

      # --- (可选) 自动部署到 Synology DSM (密码等敏感信息建议写入 config.json) ---
      - AUTO_DEPLOY_TO_SYNOLOGY=true
      - SYNO_USERNAME=your_dsm_admin_user
      - SYNO_PASSWORD=your_dsm_admin_password
      - SYNO_HOSTNAME=192.168.1.100
      - SYNO_PORT=5001
      - SYNO_SCHEME=https
      - SYNO_CERTIFICATE=
      - SYNO_CREATE=1

      # --- (可选) 企业微信通知配置 ---
      - WECOM_CORP_ID=
      - WECOM_CORP_SECRET=
      - WECOM_AGENT_ID=
      - WECOM_TOUSER=@all
      
      # --- (可选) 定时与检查配置 ---
      - CRON_SCHEDULE=0 3 * * * # Cron 表达式，默认每天凌晨3点执行
      - RENEW_DAYS_BEFORE_EXPIRY=30 # 证书过期前多少天开始尝试续签，默认30天

# 在文件末尾声明命名卷
volumes:
  acme_sh_data: